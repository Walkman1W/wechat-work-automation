# 微信自动化添加好友工具

这是一个基于Python的微信自动化工具，用于批量添加手机号为好友。该工具使用图像识别和鼠标自动化技术，模拟真实的人工操作，支持智能重试和错误处理。

## 功能特点

- 支持Excel批量导入手机号
- 智能图像识别验证，确保操作准确性
- 模拟真实人工操作，添加随机延时
- 自动保存处理进度，支持断点续处理
- 详细的日志记录和错误追踪
- 支持暂停/继续/停止操作
- 自动统计处理结果

## 使用前准备

1. 安装Python 3.7或更高版本
2. 安装所需依赖：
```bash
pip install -r requirements.txt
```

3. 准备Excel文件（phone.xlsx），格式如下：
   - 第一列：序号
   - 第二列：手机号
   - 第三列：状态（程序自动填写）
   - 第四列：备注（可选）

## 使用方法

1. 记录坐标模式：
   - 运行程序，选择模式1
   - 按照提示依次点击以下位置：
     1. 添加按钮
     2. 手机号输入框
     3. 搜索结果中的添加按钮
     4. 发送邀请按钮
     5. 确认按钮
   - 使用大写锁定键（Capslock）进行坐标记录

2. 自动化处理模式：
   - 运行程序，选择模式2
   - 程序会自动处理Excel中的手机号
   - 支持以下快捷键：
     - Ctrl+F1：暂停/继续
     - Ctrl+F2：停止处理

## 注意事项

1. 使用前请确保：
   - 微信窗口处于正确位置
   - 不要遮挡或最小化微信窗口
   - Excel文件格式正确且已关闭

2. 程序会自动处理以下情况：
   - 无效手机号
   - 界面不匹配
   - 连续失败重试
   - 异常情况处理

3. 处理结果：
   - 成功：状态显示"已处理"
   - 失败：状态显示"添加失败"
   - 无效：状态显示"无效手机号"
   - 错误：状态显示具体错误信息

## 错误处理

1. 如果出现连续两次匹配失败：
   - 程序会自动返回主菜单
   - 请检查：
     - 微信窗口是否被遮挡
     - 界面是否发生变化
     - 坐标点是否需要重新记录

2. 所有错误和操作都会记录在日志文件中：
   - 日志文件格式：automation_YYYYMMDD_HHMMSS.log
   - 失败截图保存在debug_screenshots文件夹

## 文件说明

- main.py：主程序文件
- mouse_recorder.py：鼠标坐标记录模块
- phone.xlsx：手机号数据文件
- coordinates.json：保存的坐标数据
- templates/：模板图片目录
- debug_screenshots/：调试截图目录

## 更新记录

### v1.0.0 (2023-12-27)
- 初始版本发布
- 支持基本的自动化添加功能
- 添加图像识别验证
- 实现断点续处理
- 添加结果统计功能
- 优化操作延时，模拟真实操作 